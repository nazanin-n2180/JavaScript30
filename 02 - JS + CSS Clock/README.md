<div dir="rtl">

# تمرین ۲: ساعت با استفاده از CSS و JS

در این تمرین، ما باید با استفاده از JavaScript کاری کنیم که یک ساعت آنالوگ که با CSS ساخته شده، به‌درستی کار کند. در صورت نیاز می‌تونیم تغییراتی هم در CSS اعمال کنیم.


## خلاصه

فایل HTML شامل ۳ `div` است که به‌ترتیب نمایشگر عقربه ثانیه، دقیقه و ساعت هستند:

```html
<!-- ...previous elements -->
    <div class="hand hour-hand"></div>
    <div class="hand min-hand"></div>
    <div class="hand second-hand"></div>
<!-- next elements... -->
```

کد جاوااسکریپت این تمرین خیلی پیچیده نیست. 
کافیست رفرنس المنت‌های موردنظر صفحه را در متغییرها دخیره کنیم و با آپدیت کردن CSS آن‌ها، پوزیشن عقربه‌ها را تغییر دهیم تا زمان واقعی را نشان دهند.


## مراحل پیاده‌سازی

### قسمت CSS:
۱. بصورت پیش‌فرض، همه‌ی عقربه‌ها افقی و روی هم قرار می‌گیرند. برای عمودی شدن و قرار دادن نقطه شروع عقربه‌ها از 12، به کلاس <span dir="ltr">`.hand`</span>، `transform: rotate(90deg)` را اضافه می‌کنیم.

۲. ویژگی `transform-origin` رو برای <span dir="ltr">`.hand`</span> به `100%` تغییر می‌دهیم. بصورت پیش‌فرض، این مقدار `50%`  و در مرکز المنت است ولی برای چرخش درست، باید نقطه‌ی چرخش انتهای عقربه باشد. اگر این قسمت برایتان گنگ است، یک بار با `50%` تست کنید و تفاوت رو ببینید.

۳. ویژگی `transition` برای <span dir="ltr">`.hand`</span> را با مقدار `all 0.05s` تعریف می‌کنیم.

۴. برای ویژگی `transition-timing-function` در <span dir="ltr">`.hand`</span> می‌توانید از مقادیر پیش‌فرض مثل `ease` یا `linear` استفاده کنید یا یک تابع شخصی با `cubic-bezier()` تعریف کنید.

**برای تعریف تابع `cubic-bezier()`**، در پنجره Inspect مرورگر، قسمت Styles را باز کرده و یکی از عقربه‌ها را از کد HTML انتخاب کنید، در `element.style` یک `transition-timing-function` تعریف کرده و یکی از مقادیر پیش‌فرض را انتخاب کنید، در کنار این مقدار، یک منحنی ظاهر می‌شود که با کلیک روی آن ویرایشگر cubic bezier باز شده و میتوانید تایع transition را هر طور که می‌خواهید تغییر دهید. برای مثال، در ویدیو این تمرین، `cubic-bezier(0.1, 2.7, 0.58, 1)`تعریف شد و برای روان بودن انیمیشن، زمان `transition` به `0.05s` تغییر یافت.


### قسمت JavaScript:

۱. برای هر عقربه (ساعت، دقیقه، ثانیه) یک متغیر تعریف کنید و المنت HTML مربوطه را با `querySelector` در آن‌ها ذخیره کنید.

**مثال:** <span dir="ltr">`const secondHand = document.querySelector('.second-hand');`</span>

۲. تابعی برای محاسبه درجه چرخش عقربه‌ها تعریف کنید. این تابع باید دو آرگومان داشته باشد: مقدار عددی موقعیت عقربه و حداکثر مقدار عددی ممکن برای آن عقربه. برای مثال، اگر درجه عقربه ثانیه در زمان 03:15:18 را بخواهیم، باید مقادیر (18, 60) را به تابع بدهیم.  
  <ul>
    <li>
      مقدار عددی موقعیت عقربه را بر مقدار حداکثر تقسیم می‌کنیم تا درجه چرخش بصورت درصدی بدست آید.
    </li>
    <li>
      مقدار درصدی بدست آمده را در 360 (هر عقربه 360 درجه می‌تواند بچرخد) ضرب می‌کنیم تا درجه چرخش بدست آید.
    </li>
    <li>
      در آخر، 90 درجه به حاصل بدست آمده در مرحله قبل اضافه می‌کنیم تا تغییر اولیه انجام شده در CSS جبران شود.
    </li>
  </ul>

**نتیجه:** <span dir="ltr">`const calcDegrees = (time, max) => ((time / max) * 360) + 90;`</span>

۳. یک تابع تعریف می‌کنیم که با استفاده از `setInterval`، هر ثانیه اجرا می‌شود. داخل این تابع:
    <ul>
      <li>یک مغییر را به‌عنوان یک شی جدید از <code>Date</code> تعریف می‌کنیم.</li>
      <li>سه متغییر برای درجه چرخش هر عقربه ایجاد می‌کنیم.</li>
      <li>برای هر عقربه، مقدار عددی آن را با استفاده از متدهای شی <code>Date</code> گرفته و به‌عنوان پارامتر به تابع <code>calcDegrees</code> داده و نتیجه را در متغییر مربوط ذخیره می‌کنیم.</li>
    </ul>

۴. در تابع ایحاد شده در مرحله ۳، ویژگی `transform` هر عقربه را با مقدار جدید بدست آمده به‌روزرسانی می‌کنیم.

**نتیجه:**
```js
    function setHands() {
      const now = new Date();

      const hourDegrees = calcDegrees(now.getHours(), 12);
      const minDegrees = calcDegrees(now.getMinutes(), 60);
      const secondDegrees = calcDegrees(now.getSeconds(), 60);

      // 4
      hourHand.style.transform = `rotate(${hourDegrees}deg)`;
      minHand.style.transform = `rotate(${minDegrees}deg)`;
      secondHand.style.transform = `rotate(${secondDegrees}deg)`;
    }

    setInterval(setHands, 1000);
```

---

✅ و تمام! حالا یه ساعت آنالوگ داری که زمان واقعی رو نشون میده! 🎉

> پی‌نوشت: وقتی ثانیه‌شمار به 0 میرسد، یک glitch اتفاق می‌افتد چون بجای جلو رفتن، عقربه کل مسیر را برمی‌گردد تا به نقطه 0 برسد. برای رفع این مشکل چند راه وجود دارد (برای مثال یکی از آن‌ها حذف transition در ثانیه 0 و برگرداندن آن در ثانیه بعد است که با استفاده از چند if داخل تابع setHands() می‌توان آن را انجام داد).

</div>