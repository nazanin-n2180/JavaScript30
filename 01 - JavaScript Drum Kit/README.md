<div dir="rtl">

# تمرین ۱: Drum Kit با جاوااسکریپت

در این تمرین، یک صفحه HTML نمایش داده می‌شود که شامل تعدادی `div` است. هر کدام از این `div`ها یک حرف (برای کلید کیبورد) و نام یک صدای مرتبط دارند. وقتی کاربر کلیدی را روی کیبورد فشار می‌دهد که با یکی از حروف موجود مطابقت دارد، صدای متناظر پخش می‌شود و یک افکت موقت (مثل هایلایت یا انیمیشن) روی `div` مربوطه نمایش داده می‌شود.

 با جاوااسکریپت این عملکرد را پیاده‌سازی می‌کنیم.

---

## راهنما

فایل‌های HTML ،CSS و فایل‌های صوتی آماده داده شده‌اند ([از اینجا دانلود کنید](https://github.com/wesbos/JavaScript30/tree/master/01%20-%20JavaScript%20Drum%20Kit)).

قسمت‌هایی از این کدهای آماده که در این تمرین از آن‌ها استفاده می‌کنیم:

### ویژگی‌های `*-data` در HTML

ویژگی‌های `*-data` (مثلاً `data-key`) در HTML5 به ما اجازه می‌دهند اطلاعات دلخواهی روی تگ‌های HTML ذخیره کنیم. وقتی attribute مورد نیاز ما جزو attributeهای استاندارد نباشد یا به یک ویژگی شخصی‌سازی شده نیاز داشته باشیم، از `*-data` استفاده میکنیم که بجای * میتوان هر کلمه دلخواهی را جایگزین کرد.
در این تمرین، هر `div.key` و تگ `audio` دارای یک `data-key` هستند که شماره کد کلید کیبورد را نشان می‌دهد. هر کلید بر روی کیبورد دارای کد خاصی است که در هر `keydown` و `keyup`، با استفاده از آن کد برنامه میفهمد کدام کلید فشرده شده است. برای دیدن این کدها، میتوانید از [این وبسایت](https://www.toptal.com/developers/keycode) استفاده کنید.

### کلاس CSS `playing`

در فایل CSS یک کلاس از پیش تعریف‌شده به نام `playing` وجود دارد که استایل انیمیشنی دارد. ما این کلاس را با جاوااسکریپت به `div` مناسب اضافه می‌کنیم و بعد از اتمام انیمیشن، آن را حذف می‌کنیم.

---

## مراحل پیاده‌سازی

۱. یک **event listener** روی کل `window` اضافه کن که به رویداد `keydown` گوش بدهد.

۲. تابع callback را با نام دلخواه تعریف کن و یک آرگومان `event` را به آن بده (مثلا `playSound(e)`). در این تمرین، با استفاده از `e.keyCode` می‌توانیم المنت‌های مربوط به کلید فشرده شده را پیدا کنیم. داخل تابع:
<ul>
  <li>دو متغیر تعریف کن: یکی برای پیدا کردن <code>div</code> مرتبط با کلید و یکی برای پیدا کردن <code>audio</code> مرتبط با آن.</li>
  <br>
  <li>اگر کلید فشرده شده در صفحه تعریف نشده بود، ادامه نده. ولی اگر تعریف شده بود:
    <ul>
      <li>کلاس <code>playing</code> را به <code>div</code> اضافه کن.</li>
      <li>صدای مربوطه را پخش کن.</li>
    </ul>
  </li>
</ul>

**نکته:** اگر برای یک المنت `audio` از `.play()` استفاده کنیم و چند بار پشت سر هم آن کلید را فشار دهیم، از آنجا که فایل‌های صوتی 2 تا 3 ثانیه‌ای هستند، تابع `play`صبر می‌کند تا پخش فایل صوتی کامل تمام شود و سپس اگر دوباره کلید فشرده شد آن را پخش کند. این موضوع باعث می‌شود تعداد دفعات پخش فایل از تعداد دفعات فشرده شدن کلید کمتر باشد و فاصله‌ای بین هر بار پخش شدن فایل وجود داشته باشد. به همین دلیل، قبل از پخش فایل صوتی، آن را به زمان 0 برمی‌گردانیم (`audio.currentTime = 0;`).

۳. برای حذف کلاس `playing` از `div`ها، یک متغیر دیگر تعریف کن که تمام `div`ها با کلاس `key` را انتخاب کند.

۴. وقتی یک لیست از المنت‌ها یا nodeها داریم، باید تک به تک برای هرکدام event listener قرار بدهیم و نمی‌توان event listener را برای لیست قرار داد. پس با استفاده از `.forEach`، روی همه‌ی این `div`ها، یک event listener برای رویداد `transitionend` قرار بده. این رویداد بعد از اتمام انیمیشن CSS اتفاق می‌افتد. تابع callback جداگانه‌ای با نام دلخواه برای event listener تعریف کن (مثلا removeTransition).

**نکته:** از `timeout` استفاده نکردیم چون ممکن است زمان transition تعریف شده در CSS تغییر کند و هربار باید زمان timeout را هم دستی تغییر دهیم و امکان خطا بالا می‌رود.

۵. اگر داخل تابعی که در مرحله ۴ ایجاد کردیم داشته باشیم `console.log(e)`، لیستی از رویدادهای transitionend را در کنسول می‌بینیم. از بین این رویدادها، فقط یکی از آن‌ها و معمولا طولانی‌ترین را انتخاب می‌کنند. در این تمرین، رویداد `transform` را انتخاب می‌کنیم. در نهایت، با استفاده از `this` که در اینحا به المنت `div` اجراکننده تابع اشاره دارد، `playing` را از کلاس آن `div` حذف می‌کنیم.

---

✅ تمرین یک از چالش JavaScript30 با موفقیت انجام شد 😎

</div>