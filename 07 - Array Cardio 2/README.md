<div dir="rtl">

# تمرین ۷: کار با آرایه‌ها ۲

مانند تمرین ۴، در این تمرین هم با متدهای پیش‌فرض `array`ها و نحوه استفاده از آن‌ها آشنا می‌شویم. در فایل اولیه، نتیجه موردنظر و نحوه بدست آوردن آن گفته شده است.

## ۱. متد <span dir="ltr">Array.prototype.some()</span>
متد <span dir="ltr">`Array.prototype.some()`</span> در جاوااسکریپت برای آزمودن این موضوع به کار می‌رود که آیا دست‌کم یکی از اعضای موجود آرایه شرط یک تابع predicate را برآورده می‌کند یا نه. به محض آنکه اولین مقدار بازگشتیِ truthy از تابع به دست آید، عملیات متوقف شده و نتیجه `true` برگردانده می‌شود. اگر هیچ عضوی شرایط را برآورده نکند، در پایان مقدار `false` بازگردانده خواهد شد. بنابراین هدف این متد بررسی وجود *حداقل یک عضو معتبر* مطابق با معیار تعریف‌شده است، نه الزاماً همه اعضا.

سینتکس متد به صورت `arr.some(callbackFn[, thisArg])` است. در اینجا `callbackFn` تابعی است که برای هر عضو موجود آرایه فراخوانی می‌شود و سه آرگومان دریافت می‌کند: مقدار جاری، اندیس عنصر، و خود آرایه. علاوه بر این، پارامتر اختیاری `thisArg` می‌تواند تعیین کند که در هنگام اجرای تابع، مقدار `this` چه باشد.

هنگام اجرا، متد ابتدا آرایه (یا شئ آرایه‌مانند) را به یک شئ تبدیل کرده و طول آن را یک بار محاسبه می‌کند (`length`). سپس از اندیس `0` تا `length - 1` پیمایش می‌کند. تنها اندیس‌هایی که واقعاً دارای مقدار هستند بررسی می‌شوند؛ شکاف‌ها یا holes در آرایه نادیده گرفته می‌شوند. در هر اندیس معتبر، تابع callback اجرا می‌شود و نتیجه آن ارزیابی می‌گردد. اگر این نتیجه truthy باشد، متد بلافاصله `true` را برمی‌گرداند و ادامه پیمایش متوقف می‌شود. در صورتی که به پایان آرایه برسیم و هیچ نتیجه truthy مشاهده نشود، مقدار نهایی `false` خواهد بود.

رفتار متد نسبت به تغییرات هم حساس است. هر گونه تغییر روی اعضایی که هنوز نوبتشان نرسیده، در مقدار ورودی تابع اثر می‌گذارد. اما افزودن اعضا در اندیس‌هایی بزرگ‌تر یا مساوی با طول اولیه آرایه نادیده گرفته می‌شود. همچنین اگر یک عضو پیش از بررسی حذف شود، آن اندیس تبدیل به hole می‌شود و بررسی نخواهد شد.

مقدار بازگشتی متد همیشه یک مقدار بولین (`true` یا `false`) است. این متد به طور پیش‌فرض آرایه اصلی را تغییر نمی‌دهد، مگر آنکه خود تابع callback دست به تغییر بزند. اگر `callbackFn` قابل فراخوانی نباشد، متد یک خطای `TypeError` ارسال می‌کند.

از نظر پیچیدگی زمانی، در بدترین حالت این متد باید کل آرایه را بررسی کند که منجر به O(n) می‌شود، اما در بهترین حالت می‌تواند پس از اولین نتیجه مثبت متوقف شود و عملاً O(1) باشد. همچنین `some` می‌تواند روی اشیای آرایه‌مانند نیز به کمک متدهایی مانند `call` یا `apply` اعمال گردد. در نهایت باید توجه داشت که این متد هرگز باعث ایجاد hole جدید نمی‌شود و همواره آن‌ها را رد می‌کند.


## ۲. متد <span dir="ltr">Array.prototype.every()</span>
متد <span dir="ltr">`Array.prototype.every()`</span> بررسی می‌کند آیا **تمام عناصر موجود** در آرایه، یک شرط مشخص شده توسط تابع predicate را برآورده می‌کنند یا خیر. این متد در صورت برخورد با اولین نتیجه نادرست، به صورت خودکار اجرای بررسی را متوقف می‌کند و نتیجه `false` بازمی‌گرداند.

ساختار این متد به صورت `arr.every(callbackFn[, thisArg])` است، که در آن `callbackFn` تابعی است که سه آرگومان `(currentValue, index, array)` دریافت می‌کند و آرگومان اختیاری `thisArg` می‌تواند مقدار `this` درون تابع callback را تنظیم کند.

رفتار متد به این صورت است که ابتدا مقدار `this` را به یک شئ تبدیل کرده، طول آرایه را در همان ابتدا ذخیره می‌کند و سپس از اندیس `0` تا `length - 1` پیمایش انجام می‌دهد. تابع callback تنها برای اندیس‌های موجود فراخوانی می‌شود و جای خالی یا holes نادیده گرفته می‌شوند. اگر هر فراخوانی تابع callback نتیجه نادرست (falsy) بازگرداند، متد بلافاصله مقدار `false` را بازمی‌گرداند. در صورتی که پیمایش بدون بازگشت مقدار نادرست کامل شود، مقدار `true` بازگردانده می‌شود که برای آرایه‌های خالی نیز به صورت پیش‌فرض درست تلقی می‌شود.

تغییرات انجام شده روی عناصر قبل از پیمایش روی مقادیر مشاهده شده توسط callback تأثیر می‌گذارد، در حالی که اضافه شدن عناصر فراتر از طول اولیه نادیده گرفته می‌شود و حذف عناصر قبل از بازدید، آن اندیس‌ها را به عنوان holes در نظر می‌گیرد که بررسی نمی‌شوند.

مقدار بازگشتی این متد همواره یک boolean است و خود متد هیچ تغییری در آرایه ایجاد نمی‌کند، مگر اینکه تابع callback به‌طور صریح آرایه را تغییر دهد. اگر `callbackFn` قابل فراخوانی نباشد، متد یک `TypeError` برمی‌گرداند.

پیچیدگی زمانی این متد در بدترین حالت خطی است (O(n)) اما به دلیل امکان توقف زودهنگام، ممکن است سریع‌تر نیز خاتمه یابد. به طور کلی، رفتار `every` شبیه `some` است اما جدول صحت آن برعکس است.


## ۳. متد <span dir="ltr">Array.prototype.find()</span>
از متد <span dir="ltr">`Array.prototype.find()`</span> برای یافتن اولین مقدار عنصر در یک آرایه استفاده می‌شود که یک تابع predicate برای آن مقدار درست را برگرداند. این متد به محض پیدا کردن اولین عنصر صحیح، اجرای خود را متوقف می‌کند و نتیجه را برمی‌گرداند.

سینتکس این متد به صورت `arr.find(callbackFn[, thisArg])` است که در آن `callbackFn` تابعی است که سه پارامتر می‌گیرد: مقدار فعلی عنصر، اندیس آن و خود آرایه. پارامتر اختیاری `thisArg` برای تعیین مقدار `this` داخل تابع callback استفاده می‌شود.

وقتی این متد فراخوانی می‌شود، ابتدا آرایه به یک شئ تبدیل شده و طول آن خوانده می‌شود و سپس ایندکس‌ها از `0` تا `length - 1` پیمایش می‌شوند. تابع شرطی تنها برای ایندکس‌هایی که موجود هستند اجرا می‌شود و در اولین بار که مقدار بازگشتی آن truthy باشد، مقدار همان عنصر فوراً بازگردانده می‌شود. اگر هیچ عنصری شرایط تابع را برآورده نکند، `undefined` بازگردانده می‌شود.

تغییراتی که پیش از رسیدن به یک عنصر در آرایه ایجاد شود، روی مقدار مشاهده شده توسط callback تأثیر می‌گذارد، اما اضافه کردن عناصر فراتر از طول اولیه نادیده گرفته می‌شود و حذف عناصر قبل از بازدید باعث ایجاد فضاهای خالی می‌شود که از نظر callback نادیده گرفته می‌شوند.

مقدار بازگشتی متد، همان اولین عنصر مطابق با شرط یا در صورتی که هیچ عنصر مطابقی پیدا نشود، `undefined` خواهد بود. خود این متد تغییری در آرایه ایجاد نمی‌کند مگر اینکه callback به صورت مستقیم آرایه را دستکاری کند. اگر `callbackFn` قابل فراخوانی نباشد، متد `TypeError` برمی‌گرداند.

پیچیدگی زمانی این متد در بدترین حالت خطی است (O(n))، اما ممکن است قبل از اتمام کامل آرایه به نتیجه برسد. نکته مهم دیگر این است که جستجو بر اساس تابع شرطی انجام می‌شود و مبتنی بر مقایسه مستقیم یا برابری نیست. این متد همچنین با اشیا شبیه آرایه (array-like) نیز کار می‌کند و آرایه اصلی را دست‌نخورده نگه می‌دارد.


## ۴. متد <span dir="ltr">Array.prototype.findIndex()</span>
متد <span dir="ltr">`Array.prototype.findIndex()`</span> اندیس اولین عنصری را که شرط تابع predicate را برآورده می‌کند برمی‌گرداند و در صورت یافتن اولین نتیجه درست، اجرای حلقه را متوقف می‌کند.

سینتکس این متد به شکل `arr.findIndex(callbackFn[, thisArg])` است که در آن `callbackFn` تابعی با سه آرگومان `(currentValue, index, array)` بوده و `thisArg` آرگومان اختیاری برای تعیین مقدار `this` داخل تابع است.

این متد ابتدا مقدار `this` را به یک شئ تبدیل کرده و طول آرایه را ذخیره می‌کند و سپس از اندیس `0` تا `length-1` مقادیر را بررسی می‌کند. تابع predicate تنها برای اندیس‌هایی که مقدار دارند فراخوانی می‌شود و اگر اولین نتیجه درست به دست آید، فوراً آن اندیس بازگردانده می‌شود. اگر هیچ عنصری شرط را برآورده نکند، مقدار <span dir="ltr">`-1`</span> بازگردانده می‌شود. تغییرات عناصر قبل از بررسی بر روی مقدار مشاهده‌شده توسط callback اثر می‌گذارد، عناصر اضافه‌شده بعد از طول اولیه نادیده گرفته می‌شوند و خانه‌های حذف‌شده یا خالی رد می‌شوند.

مقدار بازگشتی این متد اندیس اولین عنصر مطابق شرط یا در صورت عدم وجود، <span dir="ltr">`-1`</span> است. این متد به خودی خود آرایه اصلی را تغییر نمی‌دهد مگر اینکه callback چنین تغییری ایجاد کند. اگر `callbackFn` قابل فراخوانی نباشد، خطای `TypeError` ایجاد می‌شود.

پیچیدگی زمانی آن در بدترین حالت O(n) است، ولی اگر نتیجه یافت شود، زودتر خاتمه می‌یابد. این متد معمولاً همراه با `find` استفاده می‌شود، با این تفاوت که موقعیت عنصر را بازمی‌گرداند نه خود مقدار آن. همچنین خانه‌های خالی را نادیده می‌گیرد و روی اشیاء شبه‌آرایه نیز کار می‌کند.


---
> برای توضیحات بیشتر درباره این متدها، از داکیومنت‌هایی مثل [Mozilla docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/) می‌تونید استفاده کنید.

✅ حتما از این متدها توی پروژه‌هاتون استفاده کنین!

</div>